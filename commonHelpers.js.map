{"version":3,"file":"commonHelpers.js","sources":["../src/js/render-fuctions.js","../src/js/pixabay-api.js","../src/main.js"],"sourcesContent":["import { elements } from '../main';\n\nexport function createMarkup(arr) {\n  const markup = arr\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) =>\n        `<li class=\"item-imagesList js-item-imagesList\">\n        <a href=\"${largeImageURL}\">\n            <img src=\"${webformatURL}\" alt=\"${tags}\" width = \"360\"/>\n             </a>\n            <div>\n                <span>\n                  <p><b>Likes</b></p>\n                  <p>${likes}</p>\n                </span>\n        \n                <span>\n                  <p><b>Views</b></p>\n                  <p>${views}</p>\n                </span>\n                <span>\n                  <p><b>Comments</b></p>\n                  <p>${comments}</p>\n                </span>\n                <span>\n                  <p><b>Downloads</b></p>\n                  <p>${downloads}</p>\n                </span>\n            </div>\n       \n      </li>`\n    )\n    .join('');\n\n  elements.imagesList.insertAdjacentHTML('beforeend', markup);\n}\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport { createMarkup } from './render-fuctions';\nimport { elements } from '../main';\nimport axios, { Axios } from 'axios';\n\naxios.defaults.baseURL = 'https://pixabay.com/';\nconst ENDPOINT = 'api';\nconst KEY = '44929551-fd3f3fb9d8ead760ff0c5783d';\n\nexport async function makeRequest({ q = '', page = 1, per_page = 15 } = {}) {\n  elements.loader.style.display = 'inline-block';\n  return axios\n    .get(`${ENDPOINT}`, {\n      params: {\n        key: KEY,\n        q,\n        page,\n        per_page,\n      },\n    })\n    .then(({ data }) => data);\n}\n","import { makeRequest } from './js/pixabay-api';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport { createMarkup } from './js/render-fuctions';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nexport const elements = {\n  form: document.querySelector('.js-searchForm'),\n  serchInput: document.querySelector('.js-searchInput'),\n  searchBtn: document.querySelector('.js-searchBtn'),\n  imagesList: document.querySelector('.js-imagesList'),\n  loader: document.querySelector('.loader'),\n  loadMoreBtn: document.querySelector('.js-loadMore-btn'),\n};\n\nconst params = {\n  q: '',\n  page: 1,\n  per_page: 15,\n  maxPage: 0,\n};\nelements.form.addEventListener('submit', handlerSubmit);\n\nasync function handlerSubmit(evt) {\n  evt.preventDefault();\n  elements.imagesList.innerHTML = '';\n  params.page = 1;\n\n  params.q = elements.serchInput.value.trim();\n\n  if (!params.q) {\n    iziToast.warning({\n      title: 'The query field is empty',\n      message: 'Fill in the field',\n      position: 'topRight',\n    });\n    elements.form.reset();\n    return;\n  }\n\n  try {\n    const { total, hits } = await makeRequest(params);\n\n    elements.loader.style.display = 'none';\n\n    params.maxPage = Math.ceil(total / params.per_page);\n\n    createMarkup(hits);\n\n    const OpenGallery = new SimpleLightbox('.js-imagesList a', {\n      captions: true,\n      captionType: 'attr',\n      captionsData: 'alt',\n      captionPosition: 'bottom',\n      captionDelay: 250,\n    });\n\n    OpenGallery.on('show.simplelightbox', evt => {\n      evt.preventDefault();\n    });\n    OpenGallery.refresh();\n\n    if (hits.length > 0 && hits.length !== total) {\n      elements.loadMoreBtn.style.display = 'block';\n      elements.loadMoreBtn.addEventListener('click', handlerClick);\n    } else {\n      elements.loadMoreBtn.style.display = 'none';\n    }\n\n    if (!hits.length) {\n      iziToast.warning({\n        message: 'Nothing was found for your request',\n        position: 'topRight',\n      });\n    }\n  } catch (err) {\n    iziToast.error({\n      title: 'An error occurred',\n      message: `${err}`,\n      position: 'topRight',\n    });\n  } finally {\n    elements.form.reset();\n  }\n}\n\nasync function handlerClick(evt) {\n  params.page += 1;\n  elements.loadMoreBtn.style.display = 'none';\n  elements.loader.style.display = 'inline-block';\n\n  try {\n    const { hits } = await makeRequest(params);\n    elements.loader.style.display = 'none';\n    createMarkup(hits);\n\n    const itemCard = document.querySelector('.js-item-imagesList');\n    const heightItem = itemCard.getBoundingClientRect().height;\n\n    window.scrollBy({\n      top: heightItem * 2,\n      behavior: 'smooth',\n    });\n  } catch (err) {\n    iziToast.error({\n      title: 'An error occurred',\n      message: `${err}`,\n      position: 'topRight',\n    });\n  } finally {\n    elements.loadMoreBtn.style.display = 'block';\n    if (params.page === params.maxPage) {\n      elements.loadMoreBtn.style.display = 'none';\n      elements.loadMoreBtn.removeEventListener(('click', handlerClick));\n      iziToast.warning({\n        message: \"We're sorry, but you've reached the end of search results.\",\n        position: 'topRight',\n      });\n    }\n  }\n}\n"],"names":["createMarkup","arr","markup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","elements","axios","ENDPOINT","KEY","makeRequest","q","page","per_page","data","params","handlerSubmit","evt","iziToast","total","hits","OpenGallery","SimpleLightbox","handlerClick","err","heightItem"],"mappings":"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"}