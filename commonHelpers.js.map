{"version":3,"file":"commonHelpers.js","sources":["../src/js/render-fuctions.js","../src/js/pixabay-api.js","../src/main.js"],"sourcesContent":["import { elements } from '../main';\n\nexport function createMarkup(arr) {\n  const markup = arr\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) =>\n        `<li class=\"item-imagesList js-item-imagesList\">\n        <a href=\"${largeImageURL}\">\n            <img src=\"${webformatURL}\" alt=\"${tags}\" width = \"360\"/>\n             </a>\n            <div>\n                <span>\n                  <p><b>Likes</b></p>\n                  <p>${likes}</p>\n                </span>\n        \n                <span>\n                  <p><b>Views</b></p>\n                  <p>${views}</p>\n                </span>\n                <span>\n                  <p><b>Comments</b></p>\n                  <p>${comments}</p>\n                </span>\n                <span>\n                  <p><b>Downloads</b></p>\n                  <p>${downloads}</p>\n                </span>\n            </div>\n       \n      </li>`\n    )\n    .join('');\n\n  elements.imagesList.insertAdjacentHTML('beforeend', markup);\n}\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport { createMarkup } from './render-fuctions';\nimport { elements } from '../main';\nimport axios, { Axios } from 'axios';\n\n// axios.defaults.baseURL = 'https://pixabay.com/';\nconst ENDPOINT = 'api/';\nconst KEY = '44929551-fd3f3fb9d8ead760ff0c5783d';\nconst BASEURL = 'https://pixabay.com';\n\nexport async function makeRequest({ q = '', page = 1, per_page = 15 } = {}) {\n  elements.loader.style.display = 'inline-block';\n  elements.loadMoreBtn.style.display = 'none';\n  return axios\n    .get(`${BASEURL}/${ENDPOINT}`, {\n      params: {\n        key: KEY,\n        q,\n        page,\n        per_page,\n      },\n    })\n    .then(({ data }) => data);\n}\n","import { makeRequest } from './js/pixabay-api';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport { createMarkup } from './js/render-fuctions';\n\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nexport const elements = {\n  form: document.querySelector('.js-searchForm'),\n  serchInput: document.querySelector('.js-searchInput'),\n  searchBtn: document.querySelector('.js-searchBtn'),\n  imagesList: document.querySelector('.js-imagesList'),\n  loader: document.querySelector('.loader'),\n  loadMoreBtn: document.querySelector('.js-loadMore-btn'),\n};\n\nconst params = {\n  q: '',\n  page: 1,\n  per_page: 15,\n  maxPage: 0,\n};\nconst OpenGallery = new SimpleLightbox('.js-imagesList a', {\n  captions: true,\n  captionType: 'attr',\n  captionsData: 'alt',\n  captionPosition: 'bottom',\n  captionDelay: 250,\n});\nOpenGallery.on('show.simplelightbox', evt => {\n  evt.preventDefault();\n});\n\nelements.form.addEventListener('submit', handlerSubmit);\n\nasync function handlerSubmit(evt) {\n  evt.preventDefault();\n  elements.imagesList.innerHTML = '';\n  params.page = 1;\n\n  params.q = elements.serchInput.value.trim();\n\n  if (!params.q) {\n    iziToast.warning({\n      title: 'The query field is empty',\n      message: 'Fill in the field',\n      position: 'topRight',\n    });\n    elements.form.reset();\n    return;\n  }\n\n  try {\n    const { total, hits } = await makeRequest(params);\n\n    elements.loader.style.display = 'none';\n\n    params.maxPage = Math.ceil(total / params.per_page);\n\n    createMarkup(hits);\n\n    OpenGallery.refresh();\n\n    if (hits.length > 0 && hits.length !== total) {\n      elements.loadMoreBtn.style.display = 'block';\n      elements.loadMoreBtn.addEventListener('click', handlerClick);\n    } else {\n      elements.loadMoreBtn.style.display = 'none';\n    }\n\n    if (!hits.length) {\n      iziToast.warning({\n        message: 'Nothing was found for your request',\n        position: 'topRight',\n      });\n    }\n  } catch (err) {\n    iziToast.error({\n      title: 'An error occurred',\n      message: `${err}`,\n      position: 'topRight',\n    });\n  } finally {\n    elements.form.reset();\n  }\n}\n\nasync function handlerClick(evt) {\n  params.page += 1;\n  elements.loadMoreBtn.style.display = 'none';\n  elements.loader.style.display = 'inline-block';\n\n  try {\n    const { hits } = await makeRequest(params);\n\n    elements.loader.style.display = 'none';\n\n    createMarkup(hits);\n\n    OpenGallery.refresh();\n\n    const itemCard = document.querySelector('.js-item-imagesList');\n    const heightItem = itemCard.getBoundingClientRect().height;\n\n    window.scrollBy({\n      top: heightItem * 2,\n      behavior: 'smooth',\n    });\n  } catch (err) {\n    iziToast.error({\n      title: 'An error occurred',\n      message: `${err}`,\n      position: 'topRight',\n    });\n  } finally {\n    elements.loadMoreBtn.style.display = 'block';\n    if (params.page === params.maxPage) {\n      elements.loadMoreBtn.style.display = 'none';\n      elements.loadMoreBtn.removeEventListener('click', handlerClick);\n      iziToast.warning({\n        message: \"We're sorry, but you've reached the end of search results.\",\n        position: 'topRight',\n      });\n    }\n  }\n}\n"],"names":["createMarkup","arr","markup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","elements","ENDPOINT","KEY","BASEURL","makeRequest","q","page","per_page","axios","data","params","OpenGallery","SimpleLightbox","evt","handlerSubmit","iziToast","total","hits","handlerClick","err","heightItem"],"mappings":"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"}